<script>
  const START_POINTS = 10;

  const questions = [
    { q: 'Melyik √©vben √≠rt√°k al√° a magyar alkotm√°ny jelenlegi v√°ltozat√°t?', options: ['2011', '1990', '2004', '2010'], correctIndex: 0 },
    { q: 'Mi Magyarorsz√°g f≈ëv√°rosa?', options: ['Debrecen','Szeged','P√©cs','Budapest'], correctIndex: 3 },
    { q: 'H√°ny sz√≠ne van a magyar z√°szl√≥nak?', options: ['2','3','4','5'], correctIndex: 1 },
    { q: 'Ki √≠rta a Toldi c√≠m≈± m≈±vet?', options: ['Pet≈ëfi S√°ndor','J√≥kai M√≥r','Arany J√°nos','M√≥ricz Zsigmond'], correctIndex: 2 },
    { q: 'Melyik bolyg√≥ a Naprendszer legnagyobbika?', options: ['Mars','F√∂ld','Jupiter','Szaturnusz'], correctIndex: 2 }
  ];

  let current = 0;
  let totalScore = 0;
  let availablePoints = START_POINTS; // üîπ Aktu√°lisan felhaszn√°lhat√≥ pontok
  let totalPointsPlaced = 0;
  let currentBets = [0,0,0,0];
  let betHistory = [];
  let gameOver = false;

  const questionEl = document.getElementById('question');
  const answersEl = document.getElementById('answers');
  const feedbackEl = document.getElementById('feedback');
  const nextBtn = document.getElementById('nextBtn');
  const resetBtn = document.getElementById('resetBtn');
  const checkBtn = document.getElementById('checkBtn');
  const undoBtn = document.getElementById('undoBtn');
  const scoreEl = document.getElementById('score');
  const gameEl = document.getElementById('game');

  function renderQuestion() {
    if (gameOver) return; // üîπ ne rajzoljon √∫j k√©rd√©st, ha v√©ge a j√°t√©knak

    const item = questions[current];
    questionEl.textContent = item.q;
    answersEl.innerHTML = '';
    feedbackEl.textContent = '';
    currentBets = [0,0,0,0];
    betHistory = [];
    totalPointsPlaced = 0;

    item.options.forEach((opt, i) => {
      const btn = document.createElement('button');
      btn.className = 'ans-btn';
      btn.setAttribute('data-index', i);
      btn.innerHTML = `<span class="letter">${String.fromCharCode(65+i)}</span>
                       <span class="text">${opt}</span>
                       <span class="points-indicator" id="points-${i}">0</span>`;
      btn.addEventListener('click', () => addPoint(i));
      answersEl.appendChild(btn);
    });

    feedbackEl.textContent = `üéØ El√©rhet≈ë pontok: ${availablePoints}`;
  }

  function addPoint(i) {
    if (totalPointsPlaced >= availablePoints) {
      feedbackEl.textContent = `‚ùå M√°r elhelyezted az √∂sszes (${availablePoints}) pontot!`;
      return;
    }
    currentBets[i]++;
    totalPointsPlaced++;
    betHistory.push(i);
    animateFlash(i);
    updatePointsDisplay(i);
    feedbackEl.textContent = `‚ûï Hozz√°adt√°l 1 pontot (${totalPointsPlaced}/${availablePoints} felhaszn√°lva)`;
  }

  function undoLastPoint() {
    if (betHistory.length === 0) {
      feedbackEl.textContent = '‚ö†Ô∏è Nincs t√∂bb visszavonhat√≥ pont.';
      return;
    }
    const last = betHistory.pop();
    currentBets[last]--;
    totalPointsPlaced--;
    animateFlash(last);
    updatePointsDisplay(last);
    feedbackEl.textContent = `‚Ü©Ô∏è Visszavont√°l 1 pontot (${totalPointsPlaced}/${availablePoints} felhaszn√°lva)`;
  }

  function updatePointsDisplay(i) {
    document.getElementById(`points-${i}`).textContent = currentBets[i];
  }

  function animateFlash(i) {
    const btn = document.querySelectorAll('.ans-btn')[i];
    btn.classList.remove('flash');
    void btn.offsetWidth; // restart animation
    btn.classList.add('flash');
  }

  function checkAnswer() {
    if (gameOver) return;

    const item = questions[current];
    document.querySelectorAll('.ans-btn').forEach(b => b.classList.add('disabled'));
    const correct = item.correctIndex;
    const correctBtn = document.querySelectorAll('.ans-btn')[correct];
    correctBtn.classList.add('correct');

    let gained = 0;
    let lost = 0;

    currentBets.forEach((bet, i) => {
      if (bet > 0) {
        if (i === correct) {
          gained += bet;
        } else {
          lost += bet;
          document.querySelectorAll('.ans-btn')[i].classList.add('wrong');
        }
      }
    });

    // üîπ Csak a helyes v√°laszokra rakott pontokat adjuk az √∂sszpontsz√°mhoz!
    totalScore += gained;
    availablePoints = gained; // üîπ K√∂vetkez≈ë k√©rd√©sre ennyi pont marad
    scoreEl.textContent = totalScore;

    if (availablePoints <= 0) {
      endGame();
    } else {
      feedbackEl.textContent = `‚úÖ +${gained} pont | ‚ùå -${lost} pont elveszett ‚Üí K√∂vetkez≈ë k√∂rre marad: ${availablePoints}`;
    }
  }

  nextBtn.addEventListener('click', () => {
    if (gameOver) return;

    if (availablePoints <= 0) {
      endGame();
      return;
    }

    current++;
    if (current >= questions.length) {
      endGame();
      return;
    }

    renderQuestion();
  });

  resetBtn.addEventListener('click', resetGame);
  checkBtn.addEventListener('click', checkAnswer);
  undoBtn.addEventListener('click', undoLastPoint);

  function resetGame() {
    current = 0;
    totalScore = 0;
    availablePoints = START_POINTS;
    scoreEl.textContent = 0;
    gameOver = false;
    gameEl.classList.remove('game-over');
    document.querySelector('.game-over-overlay')?.remove();
    renderQuestion();
  }

  function endGame() {
    gameOver = true;

    // üîπ anim√°lt overlay a j√°t√©k v√©gekor
    const overlay = document.createElement('div');
    overlay.className = 'game-over-overlay';
    overlay.innerHTML = `
      <div class="game-over-box">
        <h2>üéÆ J√°t√©k v√©ge!</h2>
        <p>El√©rt pontsz√°mod: <strong>${totalScore}</strong></p>
        <button id="restartBtn">√öjraind√≠t√°s</button>
      </div>
    `;
    document.body.appendChild(overlay);
    gameEl.classList.add('game-over');

    // √∫jraind√≠t√°s gomb
    document.getElementById('restartBtn').addEventListener('click', resetGame);
  }

  // üîπ CSS anim√°ci√≥k dinamikusan besz√∫rva
  const style = document.createElement('style');
  style.textContent = `
    .game-over-overlay {
      position: fixed;
      inset: 0;
      background: radial-gradient(circle at center, rgba(255,213,74,0.1), rgba(7,20,40,0.95));
      display: flex;
      align-items: center;
      justify-content: center;
      animation: fadeIn 0.8s ease forwards;
      backdrop-filter: blur(6px);
      z-index: 1000;
    }
    .game-over-box {
      background: var(--card);
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 12px;
      padding: 30px 40px;
      text-align: center;
      box-shadow: 0 0 25px rgba(255,213,74,0.25);
      transform: scale(0.9);
      animation: popIn 0.5s ease forwards;
    }
    .game-over-box h2 {
      margin: 0 0 10px;
      color: var(--accent);
    }
    .game-over-box button {
      margin-top: 16px;
      background: var(--accent);
      color: #082338;
      border: none;
      padding: 10px 20px;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 700;
      transition: transform 0.2s ease;
    }
    .game-over-box button:hover { transform: scale(1.05); }
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    @keyframes popIn {
      from { transform: scale(0.8); opacity: 0; }
      to { transform: scale(1); opacity: 1; }
    }
    .game-over { filter: blur(3px) brightness(0.7); }
  `;
  document.head.appendChild(style);

  renderQuestion();
</script>




</body>
</html>







